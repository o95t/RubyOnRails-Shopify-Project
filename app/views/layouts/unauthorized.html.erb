<!DOCTYPE html>
<html lang="en">
    <head>
        <title><%= full_title(yield(:title)) %></title>


   <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
        <!--<link rel="stylesheet" href="build/css/intlTelInput.css">-->
        
<%= stylesheet_link_tag 'application' %>
<%= javascript_include_tag 'application' %>
    </head>

    <body>
        <div class="roww">
          <div class="wave"><svg viewBox="0 0 500 150" preserveAspectRatio="none" style="height: 100%; width: 100%;"><path d="M0.00,49.98 C149.99,150.00 271.49,-49.98 500.00,49.98 L500.00,0.00 L0.00,0.00 Z" style="stroke: none; fill: #DC281E;"></path></svg>
          </div>      
    
        <%= yield %>
        </div>

                    <script>
                    $(document).ready(function () {
                        resizeDiv();

                    $("#amx-1  input").click(function () {
						          $("#user_default_product_group").val($(this).attr("data-type"));
                    });

                    $("#amx-2  button").click(function () {
						          $("#user_default_domestic_services").val($(this).attr("data-type"));
                    });

                    $("#amx-3  input").click(function () {
						          $("#user_default_international_product_type").val($(this).attr("data-type"));
                    });

                    $("#amx-4  button").click(function () {
						          $("#user_default_international_services").val($(this).attr("data-type"));
                    });

                    $("#amx-5  button").click(function () {
						          $("#user_default_prepaid_payment_option").val($(this).attr("data-type"));
                    });

                    window.resize = function (event) {
                        resizeDiv();
                    }

                    function resizeDiv() {
                        $(".roww").css("height", $(document).height() + "px");
                    }
                    function resizeDivInternational() {

                        $(".roww").css("height", $(document).height() +40 + "px");
                    }

                    $("#user_email").focus();
                    var errors = [];

                    $("#user_email").blur(function () {
                        var email = $('#user_email').val();
                        var re = /\S+@\S+\.\S+/;
                        if (email.trim().length == 0) {
                            $('#user_email').next('div.red').remove();
                            $('#user_email').after('<div class="red">\'Email\' is Required</div>');
                            errors.push("email_required");
                            resizeDiv();
                        } else if (!re.test(email)) {
                            $('#user_email').next('div.red').remove();
                            $('#user_email').after('<div class="red">\'Email\' is not correct</div>');
                            errors.push("email_not_valid");
                            resizeDiv();
                        } else {
                            $(this).next('div.red').remove();
                            errors = removeError(errors, "email_required");
                            errors = removeError(errors, "email_not_valid");
                        }
                        makeActive();
                    });

                    $("#user_password").blur(function () {
                        var password = $('#user_password').val();
                        if (password.trim().length == 0) {
                            $('#user_password').next('div.red').remove();
                            $('#user_password').after('<div class="red">\'Password\' is Required</div>');
                            errors.push("password_required");
                            resizeDiv();
                        } else {
                            $('#user_password').next('div.red').remove();
                            errors = removeError(errors, "password_required");
                        }
                        makeActive();
                    });

                    $("#user_account_number").blur(function () {
                        var user_account_number = $('#user_account_number').val();
                        var onlyDigits = /^\d*$/;
                        if (user_account_number.trim().length == 0) {
                            $('#user_account_number').next('div.red').remove();
                            $('#user_account_number').after('<div class="red">\'Account Number\' is Required</div>');
                            errors.push("user_account_number_required");
                            resizeDiv();
                        } else if (!onlyDigits.test(user_account_number)) {
                            $('#user_account_number').next('div.red').remove();
                            $('#user_account_number').after('<div class="red">\'Account Number\' is not correct. Only numbers are allowed.</div>');
                            errors.push("user_account_number_not_valid");
                            resizeDiv();
                        } else {
                            $('#user_account_number').next('div.red').remove();
                            errors = removeError(errors, "user_account_number_required");
                            errors = removeError(errors, "user_account_number_not_valid");
                            resizeDiv();
                        }
                        makeActive();
                    });

                    $("#user_account_pin").blur(function () {
                        var user_account_pin = $('#user_account_pin').val();
                        var onlyDigits = /^\d*$/;
                        if (user_account_pin.trim().length == 0) {
                            $('#user_account_pin').next('div.red').remove();
                            $('#user_account_pin').after('<div class="red">\'Account Pin\' is Required</div>');
                            errors.push("user_account_pin_required");
                            resizeDiv();
                        } else if (!onlyDigits.test(user_account_pin)) {
                            $('#user_account_pin').next('div.red').remove();
                            $('#user_account_pin').after('<div class="red">\'Account Pin\' is not correct. Only numbers are allowed.</div>');
                            errors.push("user_account_pin_not_valid");
                            resizeDiv();
                        } else {
                            $(this).next('div.red').remove();
                            errors = removeError(errors, "user_account_pin_required");
                            errors = removeError(errors, "user_account_pin_not_valid");
                        }
                        makeActive();
                    });

                    function removeError(newArray, removeItem) {
                        var newArray = jQuery.grep(newArray, function (value) {
                            return value != removeItem;
                        });
                        return newArray;
                    }

                    function makeActive() {

                        var empty = false;
                        $('.to-valid').each(function () {
                            if ($(this).val().trim() === "") {
                                 empty = true;
                            }
                        });

                        if (errors.length === 0 && empty === false) {
                            if ($('.big-button').hasClass('passive')) {
                                $('.big-button').removeClass('passive')
                            }

                        } else {
                            if (!$('.big-button').hasClass('passive')) {
                                $('.big-button').addClass('passive')
                            }
                        }
                    }

					$('.big-button').click(function() {
   						if (!$(this).hasClass('passive')) {
                           $('.step1').hide();
                           $('.step2').fadeIn("slow")
                        }
    				});


					$('#productGroup').click(function() {
						if(!$(this).hasClass("grey-button-border")){
							resizeDivInternational();
						}
              $('.international').hide();
              $('.domestic').fadeIn("slow")
              $('#amx-1').fadeIn("slow")
              $('.button-block-pair').removeClass('button-top-bottom')                   
    				});

            $('#amx-1').click(function() {
              $('#amx-2').fadeIn("slow")  
            });

            $('#productType').click(function() {
              if(!$(this).hasClass("grey-button-border")){
                resizeDivInternational();
              }
              $('.domestic').hide();
              $('.international').fadeIn("slow")
              $('#amx-3').fadeIn("slow")
              $('.button-block-pair').removeClass('button-top-bottom')   
            });
          
            
            
            $('#productGroup').click(function() {
              $('#user_default_product_group').val('DOM')
        
            })
            $('#productType').click(function() {
              $('#user_default_product_group').val('EXP')            
            })
            $('#economyParcel').click(function () {
              $('#user_default_domestic_product_type').val('EPX')
            })
            $('#priorityParcel').click(function () {
              $('#user_default_domestic_product_type').val('PPX')
            })
            $('#ecommerceParcel').click(function () {
              $('#user_default_domestic_product_type').val('CDS')
            })
            $('#cashOnDelivery').click(function () {
              $('#user_default_domestic_services').val('CODS')
            })
            $('#prepaid').click(function () {
              $('#user_default_domestic_services').val('P')
            })
            $('#economyParcelInt').click(function () {
              $('#user_default_international_product_type').val('EPX')
            })
            $('#priorityParcelInt').click(function () {
              $('#user_default_international_product_type').val('PPX')
            })
            $('#ecommerceParcelInt').click(function () {
              $('#user_default_international_product_type').val('CDS')
            })
            $('#cashOnDeliveryInt').click(function () {
              $('#user_default_international_services').val('CODS')
            })
            $('#prepaidInt').click(function () {
              $('#user_default_international_services').val('P')
            })
            $('#deliveryDutyUnpaidInt').click(function () {
              $('#user_default_prepaid_payment_option').val('DDU')
            })
            $('#deliveryDutyPaidInt').click(function () {
              $('#user_default_prepaid_payment_option').val('DDP')
            })

           
            $('#amx-3').click(function() {
                $('#amx-4').fadeIn("slow")
                
            });
            $('#amx-4').click(function() {
                $('#amx-5').fadeIn("slow")
                
            });

 					var validErrors = [];

    				$('.grey-button').click(function() {
		                    $(this).closest('.aramex-input-block2').find(".grey-button").removeClass('grey-button-border')
		                    $(this).addClass('grey-button-border')

		                    if(typeof $(this).closest('.aramex-input-block2').attr('id') !== "undefined")
								{
  									validErrors = checkAllSelected($(this).closest('.aramex-input-block2').attr('id'));
								} 

    				});	

                    function checkAllSelected(removeItem) {

                        var newArray = jQuery.grep(validErrors, function (value) {
                            return value != removeItem;
                        });
                        newArray.push(removeItem);

                        if(newArray.length === 5){
                        	$('.button-done').removeClass('passive')
                        }
                        return newArray;
                    }

    				$('.button-back').click(function() {
		                    $('.step2').hide();
		                    $('.step1').fadeIn("slow")
    				});
    		                    });				
                </script>

    </body>
</html>
